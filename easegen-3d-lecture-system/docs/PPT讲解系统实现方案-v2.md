# PPTè®²è§£ç³»ç»Ÿå®ç°æ–¹æ¡ˆ v2.0ï¼ˆç‹¬ç«‹æ¨¡å—ç‰ˆï¼‰

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**åˆ›å»ºæ—¶é—´**: 2025-11-08
**æ›´æ–°**: é‡‡ç”¨ç‹¬ç«‹æ¨¡å—æ¶æ„ï¼Œæœ€å°åŒ–å¯¹Fayå’ŒXmovçš„ä¿®æ”¹

---

## ğŸ“‹ ç›®å½•

1. [éœ€æ±‚æ¦‚è¿°](#éœ€æ±‚æ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [æ–°æ¨¡å—è®¾è®¡](#æ–°æ¨¡å—è®¾è®¡)
4. [å®ç°æ­¥éª¤](#å®ç°æ­¥éª¤)
5. [å¯¹ç°æœ‰ç³»ç»Ÿçš„ä¿®æ”¹](#å¯¹ç°æœ‰ç³»ç»Ÿçš„ä¿®æ”¹)
6. [é…ç½®æ–‡ä»¶](#é…ç½®æ–‡ä»¶)
7. [ä»£ç å®ç°](#ä»£ç å®ç°)
8. [OBSé…ç½®](#obsé…ç½®)
9. [æµ‹è¯•æ–¹æ¡ˆ](#æµ‹è¯•æ–¹æ¡ˆ)
10. [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)

---

## éœ€æ±‚æ¦‚è¿°

### æ ¸å¿ƒç›®æ ‡

åˆ›å»ºä¸€ä¸ª**ç‹¬ç«‹çš„ä¸­é—´å±‚æ¨¡å—** `PPTLecturePlayer`ï¼Œåè°ƒEaseGenã€Fayå’ŒXmovä¸‰ä¸ªç³»ç»Ÿï¼Œå®ç°3Dæ•°å­—äººè‡ªåŠ¨è®²è§£PPTè¯¾ç¨‹çš„åŠŸèƒ½ã€‚

### åŠŸèƒ½éœ€æ±‚

1. **è‡ªåŠ¨æ’­æ”¾PPT**
   - ä»EaseGen APIè·å–è¯¾ç¨‹æ–‡æœ¬ç‰‡æ®µ
   - å…¨å±æ˜¾ç¤ºPPTå›¾ç‰‡ä½œä¸ºèƒŒæ™¯
   - è‡ªåŠ¨å¾ªç¯æ’­æ”¾æ‰€æœ‰ç‰‡æ®µ

2. **æ•°å­—äººè®²è§£**
   - 3Dæ•°å­—äººæ‚¬æµ®åœ¨å³ä¸‹è§’
   - æ ¹æ®å£æ’­ç¨¿è‡ªåŠ¨è®²è§£
   - å£å‹ã€è¡¨æƒ…ä¸è¯­éŸ³åŒæ­¥

3. **äº’åŠ¨é—®ç­”**
   - æ”¯æŒæ–‡æœ¬æ‰“æ–­æé—®
   - é€šè¿‡Fayçš„LLMå›ç­”é—®é¢˜
   - å›ç­”åé‡æ–°æ’­æ”¾å½“å‰ç‰‡æ®µ

4. **OBSæ¨æµ**
   - å°†PPT+æ•°å­—äººç»„åˆä¸ºå•ä¸€ç”»é¢
   - é€‚é…ç›´æ’­æ¨æµéœ€æ±‚

### è®¾è®¡åŸåˆ™

âœ… **æœ€å°åŒ–ä¿®æ”¹åŸç³»ç»Ÿ**: Fayå’ŒXmovåŸä»£ç å°½é‡ä¸åŠ¨
âœ… **ç‹¬ç«‹æ¨¡å—**: æ–°å»ºç‹¬ç«‹ç›®å½•ï¼Œå¯å•ç‹¬éƒ¨ç½²
âœ… **å¤ç”¨ç°æœ‰åŠŸèƒ½**: å……åˆ†åˆ©ç”¨Fayçš„TTSã€LLMå’ŒXmovçš„æ¸²æŸ“èƒ½åŠ›
âœ… **é…ç½®åŒ–**: æ‰€æœ‰é…ç½®ç‹¬ç«‹ç®¡ç†ï¼Œæ˜“äºè°ƒæ•´

### âš¡ æ ¸å¿ƒäº¤äº’æ–¹å¼ï¼ˆé‡è¦ï¼‰

**å…³é”®ç¡®è®¤**:
- âœ… **ç”¨æˆ·ç›´æ¥ä¸Fayäº¤äº’**ï¼ˆé€šè¿‡è¯­éŸ³æˆ–æ–‡æœ¬è¾“å…¥ï¼‰
- âœ… **ä¸æ˜¯é€šè¿‡æ–°æ¨¡å—è¾“å…¥**
- âœ… **æ–°æ¨¡å—åªè´Ÿè´£PPTå±•ç¤ºå’ŒåŒæ­¥æ§åˆ¶**

**åŒæ­¥æŒ‘æˆ˜**:
- Fayè¾“å‡ºä¸¤ç§å†…å®¹ï¼šè¯¾ç¨‹è®²è§£ï¼ˆéœ€åˆ‡æ¢PPTï¼‰+ ç”¨æˆ·æé—®å›ç­”ï¼ˆä¸åˆ‡æ¢PPTï¼‰
- å¿…é¡»ç²¾ç¡®åŒºåˆ†å“ªäº›å†…å®¹åº”è¯¥è§¦å‘PPTåˆ‡æ¢
- PPTæ˜¾ç¤ºå¿…é¡»ä¸Xmovæ•°å­—äººè¯´è¯åŒæ­¥

**è§£å†³æ–¹æ¡ˆ**: åŒWebSocketç›‘å¬ + æ–‡æœ¬åŒ¹é…æœºåˆ¶

---

## æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾ï¼ˆåŒWebSocketç‰ˆï¼‰

```
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚   ç”¨æˆ·è¾“å…¥     â”‚
                     â”‚ (è¯­éŸ³/æ–‡æœ¬)    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ ç›´æ¥äº¤äº’
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Fay (åŸç³»ç»Ÿ)                        â”‚
â”‚              ç«¯å£: 5000, WS: 10002               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ - ASR (è¯­éŸ³è¯†åˆ«)                       â”‚    â”‚
â”‚  â”‚ - LLM (å¯¹è¯ç”Ÿæˆ)                       â”‚    â”‚
â”‚  â”‚ - TTS (è¯­éŸ³åˆæˆ)                       â”‚    â”‚
â”‚  â”‚ - WebSocketæœåŠ¡å™¨(10002)               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                      â”‚
           â”‚ WS(è¯¾ç¨‹æ–‡æœ¬)         â”‚ WS(æ‰€æœ‰è¾“å‡º)
           â†“                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°æ¨¡å—åç«¯(5003)    â”‚  â”‚   å‰ç«¯é¡µé¢(æµè§ˆå™¨)   â”‚
â”‚  PPTLecturePlayer    â”‚  â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ FayConnector   â”‚  â”‚  â”‚  â”‚ WebSocket 1    â”‚ â”‚
â”‚  â”‚ (WS Client)    â”‚â”€â”€â”¼â”€â”€â”¼â”€â–¶â”‚ â†’ æ–°æ¨¡å—(5003) â”‚ â”‚
â”‚  â”‚ å‘é€è¯¾ç¨‹æ–‡æœ¬   â”‚  â”‚  â”‚  â”‚ æ¥æ”¶PPTæŒ‡ä»¤    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ EaseGenClient  â”‚  â”‚  â”‚  â”‚ WebSocket 2    â”‚ â”‚
â”‚  â”‚ è·å–è¯¾ç¨‹æ•°æ®   â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€â”‚ â†’ Fay(10002)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚ æ¥æ”¶è¯­éŸ³æ•°æ®   â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ æ–‡æœ¬åŒ¹é…é€»è¾‘   â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ åŒºåˆ†è¯¾ç¨‹/é—®ç­”  â”‚  â”‚  â”‚  â”‚ PPTæ˜¾ç¤ºåŒº      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚ (å…¨å±èƒŒæ™¯)     â”‚ â”‚
â”‚         â”‚            â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚ HTTP       â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚         â†“            â”‚  â”‚  â”‚ Xmov SDK       â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚ (å³ä¸‹æ‚¬æµ®)     â”‚ â”‚
â”‚  â”‚ EaseGen API    â”‚  â”‚  â”‚  â”‚ æ¥æ”¶è¯­éŸ³é©±åŠ¨   â”‚ â”‚
â”‚  â”‚ 48080ç«¯å£      â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®æ•°æ®æµ:
1. æ–°æ¨¡å— â†’ Fay: å‘é€è¯¾ç¨‹æ–‡æœ¬ + æ–‡æœ¬æ‘˜è¦(Hash)
2. æ–°æ¨¡å— â†’ å‰ç«¯WS1: å‘é€PPTå‡†å¤‡æŒ‡ä»¤ + æ–‡æœ¬æ‘˜è¦
3. Fay â†’ å‰ç«¯WS2: è¾“å‡ºTTSè¯­éŸ³æ•°æ®
4. å‰ç«¯: åŒ¹é…æ–‡æœ¬æ‘˜è¦ï¼Œå†³å®šæ˜¯å¦æ˜¾ç¤ºPPT
5. å‰ç«¯: å°†æ‰€æœ‰è¯­éŸ³æ•°æ®ä¼ ç»™Xmov SDK
```

### æ•°æ®æµå‘è¯¦è§£

#### æµç¨‹1: è‡ªåŠ¨æ’­æ”¾PPTï¼ˆå¸¦åŒæ­¥æœºåˆ¶ï¼‰

```
1. ç”¨æˆ·è®¿é—® http://localhost:5003
   å‰ç«¯åˆå§‹åŒ–:
   - WebSocket 1è¿æ¥æ–°æ¨¡å—(5003)
   - WebSocket 2è¿æ¥Fay(10002) â† å…³é”®ï¼šåŒè¿æ¥
   - åˆå§‹åŒ–Xmov SDK
   â†“
2. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹æ’­æ”¾"
   å‰ç«¯ â†’ æ–°æ¨¡å—: {action: 'play', courseId: '1024'}
   â†“
3. æ–°æ¨¡å—è°ƒç”¨EaseGen API
   GET /digitalcourse/courses/getCourseText?course_id=1024&no=1
   Header: easegen-api-key: xxx
   â†“
4. EaseGenè¿”å›ç‰‡æ®µæ•°æ®
   {
     "code": 0,
     "data": {
       "text": "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ ...",
       "img": "https://example.com/ppt/page1.jpg",
       "currentNo": 1,
       "totalNo": 50
     }
   }
   â†“
5. æ–°æ¨¡å—è®¡ç®—æ–‡æœ¬æ‘˜è¦(Hash)
   text_hash = hash("æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ ..."[:100])
   â†“
6. æ–°æ¨¡å—é€šè¿‡WS1å‘é€PPTå‡†å¤‡æŒ‡ä»¤ç»™å‰ç«¯
   {
     "type": "ppt_ready",
     "data": {
       "imageUrl": "https://example.com/ppt/page1.jpg",
       "currentNo": 1,
       "totalNo": 50,
       "textHash": 12345678  â† ç”¨äºåŒ¹é…
     }
   }
   å‰ç«¯æ”¶åˆ°å: pendingPPT = data (æš‚ä¸æ˜¾ç¤º)
   â†“
7. æ–°æ¨¡å—ä½œä¸ºWebSocketå®¢æˆ·ç«¯è¿æ¥Fay:10002
   å‘é€æ–‡æœ¬: "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ ..."
   â†“
8. Fayå¤„ç†æµç¨‹:
   æ¥æ”¶æ–‡æœ¬ â†’ LLMå¤„ç†(å¯èƒ½åŸæ–‡è¿”å›) â†’ TTSåˆæˆ
   â†’ é€šè¿‡WS(10002)å¹¿æ’­è¯­éŸ³æ•°æ®
   â†“
9. å‰ç«¯é€šè¿‡WS2ç›‘å¬Fayæ¶ˆæ¯
   æ”¶åˆ°: {
     "Topic": "human",
     "Data": {
       "Key": "text",
       "Value": "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ ...",
       "IsFirst": 1,
       "IsEnd": 0
     }
   }
   â†“
10. å‰ç«¯æ‰§è¡ŒåŒæ­¥åˆ¤æ–­(å…³é”®)
    if (msg.Data.IsFirst === 1) {
      // è®¡ç®—æ–‡æœ¬Hash
      received_hash = hash(msg.Data.Value[:100])

      // ä¸pendingPPTçš„textHashæ¯”å¯¹
      if (received_hash === pendingPPT.textHash) {
        // åŒ¹é…ï¼è¿™æ˜¯è¯¾ç¨‹å†…å®¹ï¼Œæ˜¾ç¤ºPPT
        showPPT(pendingPPT.imageUrl)
        pendingPPT = null
      } else {
        // ä¸åŒ¹é…ï¼Œè¿™æ˜¯ç”¨æˆ·é—®ç­”ï¼Œä¸æ˜¾ç¤ºPPT
      }
    }

    // æ— è®ºæ˜¯å¦åŒ¹é…ï¼Œéƒ½ä¼ ç»™Xmov SDK
    xmovSDK.speak(msg.Data.Value, msg.Data.IsFirst, msg.Data.IsEnd)
    â†“
11. æ•°å­—äººå¼€å§‹è¯´è¯ï¼ŒPPTåŒæ­¥æ˜¾ç¤º
    â†“
12. è®²è§£å®Œæˆå(IsEnd=1)ï¼Œæ–°æ¨¡å—è¯·æ±‚ä¸‹ä¸€ç‰‡æ®µ
    no = 2
    å›åˆ°æ­¥éª¤3
    â†“
13. å¾ªç¯æ’­æ”¾ï¼Œåˆ°æœ€åä¸€ç‰‡æ®µåå›åˆ°ç¬¬ä¸€ç‰‡æ®µ
```

#### æµç¨‹2: æ‰“æ–­æé—®ï¼ˆå…³é”®ï¼šç”¨æˆ·ç›´æ¥ä¸Fayäº¤äº’ï¼‰

**é‡è¦**: ç”¨æˆ·æ˜¯ç›´æ¥åœ¨Fayçš„ç•Œé¢ï¼ˆæˆ–é€šè¿‡è¯­éŸ³ï¼‰æé—®ï¼Œä¸æ˜¯é€šè¿‡æ–°æ¨¡å—çš„å‰ç«¯ï¼

```
1. ç”¨æˆ·é€šè¿‡Fayçš„Webæ§åˆ¶å°(localhost:5000)è¾“å…¥é—®é¢˜
   æˆ–é€šè¿‡è¯­éŸ³ç›´æ¥å‘Fayæé—®:
   "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ?"
   â†“
2. Fayæ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥
   ASRè¯†åˆ«(å¦‚æœæ˜¯è¯­éŸ³) â†’ LLMç”Ÿæˆå›ç­”
   â†“
3. Fayé€šè¿‡TTSåˆæˆå›ç­”è¯­éŸ³
   "æœºå™¨å­¦ä¹ æ˜¯ä¸€ç§è®©è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ çš„æŠ€æœ¯..."
   â†“
4. Fayé€šè¿‡WS(10002)å¹¿æ’­è¯­éŸ³æ•°æ®
   {
     "Topic": "human",
     "Data": {
       "Key": "text",
       "Value": "æœºå™¨å­¦ä¹ æ˜¯ä¸€ç§è®©è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ çš„æŠ€æœ¯...",
       "IsFirst": 1,
       "IsEnd": 0
     }
   }
   â†“
5. å‰ç«¯é€šè¿‡WS2ç›‘å¬åˆ°Fayæ¶ˆæ¯
   â†“
6. å‰ç«¯æ‰§è¡ŒåŒæ­¥åˆ¤æ–­
   received_hash = hash("æœºå™¨å­¦ä¹ æ˜¯ä¸€ç§è®©è®¡ç®—æœº..."[:100])

   if (pendingPPT && received_hash === pendingPPT.textHash) {
     // åŒ¹é…è¯¾ç¨‹å†…å®¹
     showPPT(pendingPPT.imageUrl)
   } else {
     // ä¸åŒ¹é…ï¼è¿™æ˜¯ç”¨æˆ·é—®ç­”
     // ä¸æ˜¾ç¤ºPPTï¼Œä¿æŒå½“å‰é¡µé¢
     console.log('ç”¨æˆ·é—®ç­”ï¼Œä¸åˆ‡æ¢PPT')
   }

   // ä¼ ç»™Xmov SDKï¼ˆæ•°å­—äººå›ç­”é—®é¢˜ï¼‰
   xmovSDK.speak(msg.Data.Value, msg.Data.IsFirst, msg.Data.IsEnd)
   â†“
7. æ•°å­—äººå¼€å§‹è¯´è¯å›ç­”é—®é¢˜ï¼ŒPPTä¿æŒä¸å˜
   â†“
8. å›ç­”å®Œæˆå(IsEnd=1)
   æ–°æ¨¡å—æ£€æµ‹åˆ°ä¸€æ®µæ—¶é—´æ²¡æœ‰æ–°çš„è¯¾ç¨‹å†…å®¹
   å¯é€‰ï¼šè‡ªåŠ¨æ¢å¤æ’­æ”¾å½“å‰ç‰‡æ®µ
   æˆ–ï¼šç­‰å¾…ç”¨æˆ·ç»§ç»­æ’­æ”¾
```

**åŒºåˆ†æœºåˆ¶**:
- è¯¾ç¨‹å†…å®¹: pendingPPTå­˜åœ¨ + textHashåŒ¹é… â†’ æ˜¾ç¤ºPPT
- ç”¨æˆ·é—®ç­”: æ²¡æœ‰pendingPPTæˆ–Hashä¸åŒ¹é… â†’ ä¸æ˜¾ç¤ºPPT

---

## ğŸ”‘ åŒæ­¥æœºåˆ¶è¯¦è§£ï¼ˆæ ¸å¿ƒï¼‰

### æŒ‘æˆ˜åˆ†æ

**é—®é¢˜**: Fayçš„WebSocket(10002)ä¼šå¹¿æ’­æ‰€æœ‰TTSè¾“å‡ºï¼ŒåŒ…æ‹¬ï¼š
1. è¯¾ç¨‹è®²è§£å†…å®¹ï¼ˆéœ€è¦åˆ‡æ¢PPTï¼‰
2. ç”¨æˆ·æé—®çš„å›ç­”ï¼ˆä¸åº”åˆ‡æ¢PPTï¼‰

**æ— æ³•åŒºåˆ†çš„åŸå› **:
- æ¶ˆæ¯æ ¼å¼å®Œå…¨ç›¸åŒ
- æ²¡æœ‰"æ¶ˆæ¯ç±»å‹"å­—æ®µ
- æ— æ³•é€šè¿‡Topicæˆ–KeyåŒºåˆ†

**å¿…é¡»è§£å†³**: PPTæ˜¾ç¤ºå¿…é¡»ä¸è¯¾ç¨‹å†…å®¹ç²¾ç¡®åŒæ­¥ï¼Œä½†ä¸èƒ½è¢«ç”¨æˆ·é—®ç­”è§¦å‘

### è§£å†³æ–¹æ¡ˆï¼šæ–‡æœ¬å“ˆå¸ŒåŒ¹é…

#### æ ¸å¿ƒæ€è·¯

```
æ–°æ¨¡å—å‘é€è¯¾ç¨‹æ–‡æœ¬å‰:
  â”œâ”€ è®¡ç®—æ–‡æœ¬æ‘˜è¦(Hash)
  â”œâ”€ è®°å½•è¿™ä¸ªHashä½œä¸º"å¾…åŒ¹é…æ ‡è®°"
  â”œâ”€ é€šçŸ¥å‰ç«¯å‡†å¤‡æ˜¾ç¤ºPPT(é™„å¸¦Hash)
  â””â”€ å‘é€æ–‡æœ¬ç»™Fay

å‰ç«¯æ”¶åˆ°Fayè¾“å‡ºæ—¶:
  â”œâ”€ è®¡ç®—æ”¶åˆ°æ–‡æœ¬çš„Hash
  â”œâ”€ ä¸"å¾…åŒ¹é…æ ‡è®°"æ¯”å¯¹
  â”œâ”€ åŒ¹é… â†’ è¯¾ç¨‹å†…å®¹ â†’ æ˜¾ç¤ºPPT
  â””â”€ ä¸åŒ¹é… â†’ ç”¨æˆ·é—®ç­” â†’ ä¸å¤„ç†
```

#### å“ˆå¸Œç®—æ³•

**JavaScriptå®ç°** (å‰ç«¯):
```javascript
function simpleHash(str) {
  // å–å‰100ä¸ªå­—ç¬¦ï¼Œé¿å…LLMæ”¹å†™å½±å“
  const sample = str.substring(0, 100);

  let hash = 0;
  for (let i = 0; i < sample.length; i++) {
    const char = sample.charCodeAt(i);
    hash = ((hash << 5) - hash) + char;
    hash = hash & hash; // Convert to 32bit integer
  }
  return hash;
}
```

**Pythonå®ç°** (åç«¯):
```python
def simple_hash(text: str) -> int:
    """è®¡ç®—æ–‡æœ¬çš„ç®€å•å“ˆå¸Œå€¼"""
    # å–å‰100ä¸ªå­—ç¬¦
    sample = text[:100]

    hash_value = 0
    for char in sample:
        hash_value = ((hash_value << 5) - hash_value) + ord(char)
        hash_value = hash_value & 0xFFFFFFFF  # 32ä½æ•´æ•°

    return hash_value
```

#### ä¸ºä»€ä¹ˆåªå–å‰100ä¸ªå­—ç¬¦ï¼Ÿ

1. **Fayçš„LLMå¯èƒ½æ”¹å†™æ–‡æœ¬**
   - è¾“å…¥: "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ æœºå™¨å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ã€‚"
   - è¾“å‡º: "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ æœºå™¨å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹..."
   - å¼€å¤´éƒ¨åˆ†é€šå¸¸ä¿æŒä¸å˜

2. **æ€§èƒ½è€ƒè™‘**
   - å“ˆå¸Œè®¡ç®—å¿«é€Ÿ
   - å‡å°‘ç½‘ç»œä¼ è¾“æ•°æ®é‡

3. **è¶³å¤Ÿå”¯ä¸€æ€§**
   - 100ä¸ªå­—ç¬¦çš„Hashå·²ç»è¶³å¤ŸåŒºåˆ†ä¸åŒå†…å®¹

### å·¥ä½œæµç¨‹æ—¶åºå›¾

```
æ—¶é—´è½´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>

æ–°æ¨¡å—åç«¯:
  â”‚
  â”œâ”€ [t0] è·å–è¯¾ç¨‹ç‰‡æ®µtext="æ¬¢è¿æ¥åˆ°..."
  â”‚
  â”œâ”€ [t1] è®¡ç®—Hash: h1 = hash(text[:100])
  â”‚        è®°å½•: pending_hash = h1
  â”‚
  â”œâ”€ [t2] é€šçŸ¥å‰ç«¯: {type:'ppt_ready', hash:h1, img:...}
  â”‚
  â””â”€ [t3] å‘é€textç»™Fay
         â”‚
         â”‚ (Fayå¤„ç†ä¸­...)
         â”‚
å‰ç«¯é¡µé¢: â”‚
  â”‚       â”‚
  â”œâ”€ [t2] æ”¶åˆ°ppt_ready
  â”‚        å­˜å‚¨: pendingPPT = {hash:h1, img:...}
  â”‚
  â”œâ”€ [t5] æ”¶åˆ°Fayçš„WSæ¶ˆæ¯
  â”‚        text2 = "æ¬¢è¿æ¥åˆ°..."
  â”‚        h2 = hash(text2[:100])
  â”‚
  â”œâ”€ [t5] æ¯”å¯¹: h1 == h2?
  â”‚        âœ… åŒ¹é…ï¼æ˜¾ç¤ºPPT
  â”‚        pendingPPT = null
  â”‚
  â””â”€ [t5] ä¼ ç»™Xmov SDKè¯´è¯
         â”‚
         â†“
      æ•°å­—äººè¯´è¯ + PPTæ˜¾ç¤ºåŒæ­¥ï¼
```

### è¾¹ç•Œæƒ…å†µå¤„ç†

#### æƒ…å†µ1: LLMå¤§å¹…æ”¹å†™æ–‡æœ¬

**åœºæ™¯**: Fayçš„LLMå°†è¯¾ç¨‹æ–‡æœ¬å®Œå…¨æ”¹å†™

**è§£å†³æ–¹æ¡ˆ**:
- åœ¨Fayé…ç½®ä¸­å…³é—­LLMå¤„ç†ï¼Œæˆ–ä½¿ç”¨"echo"æ¨¡å¼
- æˆ–è€…ï¼šä½¿ç”¨æ›´å®½æ¾çš„åŒ¹é…ç­–ç•¥ï¼ˆæ¨¡ç³ŠåŒ¹é…å‰50ä¸ªå­—ç¬¦ï¼‰

#### æƒ…å†µ2: å¤šæ¡æ¶ˆæ¯åŒæ—¶åˆ°è¾¾

**åœºæ™¯**: ç”¨æˆ·å¿«é€Ÿè¿ç»­æé—®

**è§£å†³æ–¹æ¡ˆ**:
```javascript
let pendingPPTQueue = [];  // é˜Ÿåˆ—ï¼Œä¸æ˜¯å•ä¸ªå¯¹è±¡

// æ”¶åˆ°ppt_readyæ—¶
pendingPPTQueue.push({hash, imageUrl, ...});

// æ”¶åˆ°Fayæ¶ˆæ¯æ—¶
for (let i = 0; i < pendingPPTQueue.length; i++) {
  if (hash(msg.Value[:100]) === pendingPPTQueue[i].hash) {
    showPPT(pendingPPTQueue[i].imageUrl);
    pendingPPTQueue.splice(i, 1);
    break;
  }
}
```

#### æƒ…å†µ3: è¶…æ—¶æœªåŒ¹é…

**åœºæ™¯**: æ–°æ¨¡å—å‘é€äº†textï¼Œä½†5ç§’å†…å‰ç«¯æ²¡æ”¶åˆ°åŒ¹é…çš„Fayæ¶ˆæ¯

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// è®¾ç½®è¶…æ—¶æ¸…ç†
setTimeout(() => {
  if (pendingPPT && pendingPPT.hash === h1) {
    console.warn('PPTåŒ¹é…è¶…æ—¶ï¼Œæ¸…ç†pendingPPT');
    pendingPPT = null;
  }
}, 5000);  // 5ç§’è¶…æ—¶
```

### è°ƒè¯•æ”¯æŒ

**å‰ç«¯æ§åˆ¶å°è¾“å‡º**:
```javascript
console.log('[åŒæ­¥] å¾…åŒ¹é…Hash:', pendingPPT?.hash);
console.log('[åŒæ­¥] æ”¶åˆ°æ–‡æœ¬Hash:', receivedHash);
console.log('[åŒæ­¥] åŒ¹é…ç»“æœ:', matched ? 'âœ…è¯¾ç¨‹å†…å®¹' : 'âŒç”¨æˆ·é—®ç­”');
```

**åç«¯æ—¥å¿—è¾“å‡º**:
```python
print(f"[åŒæ­¥] è¯¾ç¨‹æ–‡æœ¬Hash: {text_hash}")
print(f"[åŒæ­¥] æ–‡æœ¬å‰100å­—ç¬¦: {text[:100]}")
```

---

## æ–°æ¨¡å—è®¾è®¡

### ç›®å½•ç»“æ„

```
opensource-demos/
â”œâ”€â”€ Fay/                    (åŸç³»ç»Ÿï¼Œä¸ä¿®æ”¹)
â”œâ”€â”€ XmovAvatarSDK/          (åŸç³»ç»Ÿï¼Œä¸ä¿®æ”¹)
â””â”€â”€ PPTLecturePlayer/       (æ–°æ¨¡å—)
    â”œâ”€â”€ .venv/              (è™šæ‹Ÿç¯å¢ƒï¼Œä½¿ç”¨uvåˆ›å»º)
    â”œâ”€â”€ app.py              (Flaskä¸»åº”ç”¨)
    â”œâ”€â”€ config.yaml         (é…ç½®æ–‡ä»¶)
    â”œâ”€â”€ requirements.txt    (ä¾èµ–åˆ—è¡¨)
    â”œâ”€â”€ core/               (æ ¸å¿ƒæ¨¡å—)
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ easegen_client.py      (EaseGen APIå®¢æˆ·ç«¯)
    â”‚   â”œâ”€â”€ fay_connector.py       (Fay WebSocketè¿æ¥å™¨)
    â”‚   â””â”€â”€ playback_controller.py (æ’­æ”¾æ§åˆ¶å™¨)
    â”œâ”€â”€ templates/          (HTMLæ¨¡æ¿)
    â”‚   â””â”€â”€ index.html      (ä¸»é¡µé¢)
    â”œâ”€â”€ static/             (é™æ€èµ„æº)
    â”‚   â”œâ”€â”€ css/
    â”‚   â”‚   â””â”€â”€ style.css
    â”‚   â””â”€â”€ js/
    â”‚       â””â”€â”€ player.js
    â”œâ”€â”€ start.py            (å¯åŠ¨è„šæœ¬)
    â””â”€â”€ README.md           (ä½¿ç”¨è¯´æ˜)
```

---

## å®ç°æ­¥éª¤

### é˜¶æ®µ1: é¡¹ç›®åˆå§‹åŒ–

**ç›®æ ‡**: åˆ›å»ºæ–°æ¨¡å—ç›®å½•å’ŒåŸºç¡€ç»“æ„

#### 1.1 åˆ›å»ºç›®å½•å’Œè™šæ‹Ÿç¯å¢ƒ

```bash
cd E:/code/yzpd/easegen-front/opensource-demos
mkdir PPTLecturePlayer
cd PPTLecturePlayer

# ä½¿ç”¨uvåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv
.venv\Scripts\activate

# å®‰è£…ä¾èµ–
uv pip install flask flask-socketio flask-cors requests websocket-client pyyaml python-dotenv
```

#### 1.2 åˆ›å»ºrequirements.txt

```txt
flask==3.0.0
flask-socketio==5.3.5
flask-cors==4.0.0
requests==2.31.0
websocket-client==1.7.0
pyyaml==6.0.1
python-dotenv==1.0.0
```

#### 1.3 åˆ›å»ºé…ç½®æ–‡ä»¶

**æ–‡ä»¶**: `config.yaml`

```yaml
# PPTLecturePlayer é…ç½®æ–‡ä»¶

server:
  host: '0.0.0.0'
  port: 5003
  debug: true

easegen:
  base_url: 'http://localhost:48080'
  api_key: ''  # éœ€è¦ç”¨æˆ·å¡«å†™
  default_course_id: '1024'

fay:
  websocket_url: 'ws://127.0.0.1:10002'
  reconnect_interval: 5  # ç§’

xmov:
  app_id: 'your_app_id'
  app_secret: 'your_app_secret'
  gateway_server: 'https://nebula-agent.xingyun3d.com/user/v1/ttsa/session'

playback:
  auto_start: false
  loop: true
  page_interval: 2  # ç¿»é¡µé—´éš”(ç§’)
  speech_speed_multiplier: 1.0  # è¯­é€Ÿå€æ•°ï¼Œç”¨äºä¼°ç®—è®²è§£æ—¶é•¿
```

### é˜¶æ®µ2: åç«¯æ ¸å¿ƒæ¨¡å—å¼€å‘

#### 2.1 EaseGen APIå®¢æˆ·ç«¯

**æ–‡ä»¶**: `core/easegen_client.py`

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
EaseGen API å®¢æˆ·ç«¯
è´Ÿè´£ä¸EaseGenåç«¯äº¤äº’ï¼Œè·å–è¯¾ç¨‹ç‰‡æ®µæ•°æ®
"""
import requests
from typing import Optional, Dict


class EaseGenClient:
    """EaseGen APIå®¢æˆ·ç«¯"""

    def __init__(self, base_url: str, api_key: str):
        """
        åˆå§‹åŒ–å®¢æˆ·ç«¯

        Args:
            base_url: EaseGen APIåŸºç¡€URL
            api_key: APIå¯†é’¥
        """
        self.base_url = base_url.rstrip('/')
        self.api_key = api_key
        self.session = requests.Session()
        self.session.headers.update({
            'easegen-api-key': api_key,
            'Content-Type': 'application/json'
        })

    def get_course_text(self, course_id: str, no: Optional[int] = None) -> Optional[Dict]:
        """
        è·å–è¯¾ç¨‹æ–‡æœ¬ç‰‡æ®µ

        Args:
            course_id: è¯¾ç¨‹ID
            no: ç‰‡æ®µåºå·ï¼Œä¸ä¼ åˆ™è¿”å›ä¸‹ä¸€æ®µ

        Returns:
            {
                'text': 'è®²ç¨¿æ–‡æœ¬',
                'img': 'PPTå›¾ç‰‡URL',
                'currentNo': 1,
                'totalNo': 50,
                'progress': '1/50'
            }
        """
        try:
            url = f"{self.base_url}/digitalcourse/courses/getCourseText"
            params = {'course_id': course_id}

            if no is not None:
                params['no'] = no

            response = self.session.get(url, params=params, timeout=10)
            response.raise_for_status()

            result = response.json()

            if result.get('code') == 0:
                return result.get('data')
            else:
                print(f"[EaseGen] APIé”™è¯¯: {result.get('msg')}")
                return None

        except Exception as e:
            print(f"[EaseGen] è¯·æ±‚å¤±è´¥: {e}")
            return None

    def get_course_list(self, page_no: int = 1, page_size: int = 10) -> Optional[Dict]:
        """
        è·å–è¯¾ç¨‹åˆ—è¡¨

        Args:
            page_no: é¡µç 
            page_size: æ¯é¡µæ•°é‡

        Returns:
            {
                'list': [...],
                'total': 100
            }
        """
        try:
            url = f"{self.base_url}/digitalcourse/courses/getCoursePage"
            params = {
                'pageNo': page_no,
                'pageSize': page_size
            }

            response = self.session.get(url, params=params, timeout=10)
            response.raise_for_status()

            result = response.json()

            if result.get('code') == 0:
                return result.get('data')
            else:
                print(f"[EaseGen] APIé”™è¯¯: {result.get('msg')}")
                return None

        except Exception as e:
            print(f"[EaseGen] è¯·æ±‚å¤±è´¥: {e}")
            return None
```

#### 2.2 Fay WebSocketè¿æ¥å™¨

**æ–‡ä»¶**: `core/fay_connector.py`

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Fay WebSocket è¿æ¥å™¨
ä½œä¸ºWebSocketå®¢æˆ·ç«¯è¿æ¥åˆ°Fayï¼Œå‘é€æ–‡æœ¬å¹¶æ¥æ”¶è¯­éŸ³å“åº”
"""
import json
import time
import threading
from websocket import WebSocketApp, ABNF
from typing import Callable, Optional


class FayConnector:
    """Fay WebSocketè¿æ¥å™¨"""

    def __init__(self, websocket_url: str, on_message_callback: Optional[Callable] = None):
        """
        åˆå§‹åŒ–è¿æ¥å™¨

        Args:
            websocket_url: Fayçš„WebSocketåœ°å€ (ws://127.0.0.1:10002)
            on_message_callback: æ”¶åˆ°æ¶ˆæ¯æ—¶çš„å›è°ƒå‡½æ•°
        """
        self.websocket_url = websocket_url
        self.on_message_callback = on_message_callback
        self.ws = None
        self.connected = False
        self.reconnect_thread = None

    def connect(self):
        """è¿æ¥åˆ°Fay WebSocketæœåŠ¡å™¨"""
        print(f"[Fay] æ­£åœ¨è¿æ¥åˆ° {self.websocket_url}...")

        self.ws = WebSocketApp(
            self.websocket_url,
            on_open=self._on_open,
            on_message=self._on_message,
            on_error=self._on_error,
            on_close=self._on_close
        )

        # åœ¨æ–°çº¿ç¨‹ä¸­è¿è¡ŒWebSocket
        ws_thread = threading.Thread(target=self.ws.run_forever, daemon=True)
        ws_thread.start()

    def _on_open(self, ws):
        """WebSocketè¿æ¥å»ºç«‹"""
        print("[Fay] WebSocketè¿æ¥å·²å»ºç«‹")
        self.connected = True

        # å‘é€åˆå§‹åŒ–æ¶ˆæ¯
        init_message = {
            'Username': 'PPTLecturePlayer',
            'Output': False  # å‘Šè¯‰Fayéœ€è¦éŸ³é¢‘è¾“å‡º
        }
        self.ws.send(json.dumps(init_message))
        print("[Fay] å·²å‘é€åˆå§‹åŒ–æ¶ˆæ¯")

    def _on_message(self, ws, message):
        """æ”¶åˆ°WebSocketæ¶ˆæ¯"""
        try:
            data = json.loads(message)
            print(f"[Fay] æ”¶åˆ°æ¶ˆæ¯: {data.get('Topic', 'unknown')}")

            if self.on_message_callback:
                self.on_message_callback(data)

        except Exception as e:
            print(f"[Fay] å¤„ç†æ¶ˆæ¯å‡ºé”™: {e}")

    def _on_error(self, ws, error):
        """WebSocketé”™è¯¯"""
        print(f"[Fay] WebSocketé”™è¯¯: {error}")
        self.connected = False

    def _on_close(self, ws, close_status_code, close_msg):
        """WebSocketè¿æ¥å…³é—­"""
        print(f"[Fay] WebSocketè¿æ¥å·²å…³é—­: {close_msg}")
        self.connected = False

        # å°è¯•é‡è¿
        self._schedule_reconnect()

    def _schedule_reconnect(self):
        """å®‰æ’é‡æ–°è¿æ¥"""
        if self.reconnect_thread and self.reconnect_thread.is_alive():
            return

        def reconnect():
            print("[Fay] 5ç§’åå°è¯•é‡æ–°è¿æ¥...")
            time.sleep(5)
            if not self.connected:
                self.connect()

        self.reconnect_thread = threading.Thread(target=reconnect, daemon=True)
        self.reconnect_thread.start()

    def send_text(self, text: str):
        """
        å‘é€æ–‡æœ¬ç»™Fayå¤„ç†

        æ³¨æ„: è¿™é‡Œéœ€è¦æ ¹æ®Fayçš„å®é™…åè®®è°ƒæ•´
        å¯èƒ½éœ€è¦æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥æˆ–ä½¿ç”¨ç‰¹å®šçš„æ¶ˆæ¯æ ¼å¼
        """
        if not self.connected:
            print("[Fay] æœªè¿æ¥ï¼Œæ— æ³•å‘é€æ–‡æœ¬")
            return False

        try:
            # æ–¹å¼1: ç›´æ¥å‘é€æ–‡æœ¬(éœ€è¦ç¡®è®¤Fayæ˜¯å¦æ”¯æŒ)
            message = {
                'action': 'speak',
                'text': text
            }

            self.ws.send(json.dumps(message))
            print(f"[Fay] å·²å‘é€æ–‡æœ¬: {text[:50]}...")
            return True

        except Exception as e:
            print(f"[Fay] å‘é€æ–‡æœ¬å¤±è´¥: {e}")
            return False

    def disconnect(self):
        """æ–­å¼€è¿æ¥"""
        if self.ws:
            self.ws.close()
            self.connected = False
```

#### 2.3 æ’­æ”¾æ§åˆ¶å™¨

**æ–‡ä»¶**: `core/playback_controller.py`

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ’­æ”¾æ§åˆ¶å™¨
ç®¡ç†PPTæ’­æ”¾é€»è¾‘ã€è¿›åº¦å’ŒçŠ¶æ€
"""
import time
import threading
from typing import Optional, Callable, Dict
from .easegen_client import EaseGenClient
from .fay_connector import FayConnector


class PlaybackController:
    """æ’­æ”¾æ§åˆ¶å™¨"""

    def __init__(self, easegen_client: EaseGenClient, fay_connector: FayConnector,
                 on_state_change: Optional[Callable] = None):
        """
        åˆå§‹åŒ–æ§åˆ¶å™¨

        Args:
            easegen_client: EaseGenå®¢æˆ·ç«¯
            fay_connector: Fayè¿æ¥å™¨
            on_state_change: çŠ¶æ€å˜åŒ–å›è°ƒå‡½æ•°
        """
        self.easegen_client = easegen_client
        self.fay_connector = fay_connector
        self.on_state_change = on_state_change

        self.course_id = None
        self.current_no = 1
        self.total_no = 0

        self.is_playing = False
        self.is_paused = False
        self.is_interrupted = False

        self.play_thread = None

    def start_playback(self, course_id: str):
        """
        å¼€å§‹æ’­æ”¾è¯¾ç¨‹

        Args:
            course_id: è¯¾ç¨‹ID
        """
        if self.is_playing:
            print("[Playback] å·²åœ¨æ’­æ”¾ä¸­")
            return

        self.course_id = course_id
        self.current_no = 1
        self.is_playing = True
        self.is_paused = False
        self.is_interrupted = False

        print(f"[Playback] å¼€å§‹æ’­æ”¾è¯¾ç¨‹: {course_id}")

        # åœ¨æ–°çº¿ç¨‹ä¸­æ’­æ”¾
        self.play_thread = threading.Thread(target=self._playback_loop, daemon=True)
        self.play_thread.start()

    def _playback_loop(self):
        """æ’­æ”¾å¾ªç¯"""
        while self.is_playing:
            try:
                # å¦‚æœæš‚åœæˆ–è¢«æ‰“æ–­ï¼Œç­‰å¾…
                if self.is_paused or self.is_interrupted:
                    time.sleep(1)
                    continue

                # è·å–å½“å‰ç‰‡æ®µ
                segment = self.easegen_client.get_course_text(
                    self.course_id,
                    self.current_no
                )

                if not segment:
                    print(f"[Playback] æ— æ³•è·å–ç¬¬{self.current_no}ç‰‡æ®µ")
                    time.sleep(5)
                    continue

                self.total_no = segment.get('totalNo', 0)

                print(f"[Playback] æ’­æ”¾ç‰‡æ®µ {segment['currentNo']}/{self.total_no}")

                # é€šçŸ¥å‰ç«¯æ›´æ–°PPT
                if self.on_state_change:
                    self.on_state_change({
                        'type': 'ppt_update',
                        'data': {
                            'imageUrl': segment.get('img'),
                            'currentNo': segment.get('currentNo'),
                            'totalNo': segment.get('totalNo'),
                            'progress': segment.get('progress')
                        }
                    })

                # ç­‰å¾…PPTå›¾ç‰‡åŠ è½½
                time.sleep(0.5)

                # å‘é€æ–‡æœ¬ç»™Fay
                text = segment.get('text', '')
                if text:
                    self.fay_connector.send_text(text)

                    # ä¼°ç®—è®²è§£æ—¶é•¿(å‡è®¾1ç§’3ä¸ªå­—)
                    estimated_duration = len(text) / 3
                    time.sleep(max(estimated_duration, 3))
                else:
                    time.sleep(3)

                # ç¿»åˆ°ä¸‹ä¸€ç‰‡æ®µ
                self.current_no += 1

                # å¦‚æœåˆ°è¾¾æœ€åï¼Œå¾ªç¯æ’­æ”¾
                if self.current_no > self.total_no:
                    print("[Playback] æ’­æ”¾å®Œæˆï¼Œé‡æ–°å¼€å§‹")
                    self.current_no = 1

                # é¡µé¢åˆ‡æ¢é—´éš”
                time.sleep(2)

            except Exception as e:
                print(f"[Playback] æ’­æ”¾å‡ºé”™: {e}")
                import traceback
                traceback.print_exc()
                time.sleep(5)

    def pause(self):
        """æš‚åœæ’­æ”¾"""
        self.is_paused = True
        print("[Playback] å·²æš‚åœ")

    def resume(self):
        """æ¢å¤æ’­æ”¾"""
        self.is_paused = False
        print("[Playback] å·²æ¢å¤")

    def interrupt(self):
        """æ ‡è®°ä¸ºè¢«æ‰“æ–­"""
        self.is_interrupted = True
        self.pause()
        print("[Playback] æ’­æ”¾è¢«æ‰“æ–­")

    def resume_after_interrupt(self):
        """æ‰“æ–­åæ¢å¤ï¼Œé‡æ’­å½“å‰ç‰‡æ®µ"""
        self.is_interrupted = False

        # é‡æ–°è¯·æ±‚å½“å‰ç‰‡æ®µ
        segment = self.easegen_client.get_course_text(
            self.course_id,
            self.current_no
        )

        if segment:
            # é€šçŸ¥å‰ç«¯æ›´æ–°PPT
            if self.on_state_change:
                self.on_state_change({
                    'type': 'ppt_update',
                    'data': {
                        'imageUrl': segment.get('img'),
                        'currentNo': segment.get('currentNo'),
                        'totalNo': segment.get('totalNo'),
                        'progress': segment.get('progress')
                    }
                })

            # å‘é€æ–‡æœ¬ç»™Fay
            text = segment.get('text', '')
            if text:
                self.fay_connector.send_text(text)

        self.resume()
        print("[Playback] å·²æ¢å¤æ’­æ”¾å½“å‰ç‰‡æ®µ")

    def stop(self):
        """åœæ­¢æ’­æ”¾"""
        self.is_playing = False
        print("[Playback] å·²åœæ­¢")
```

### é˜¶æ®µ3: Flaskä¸»åº”ç”¨

**æ–‡ä»¶**: `app.py`

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
PPTLecturePlayer ä¸»åº”ç”¨
"""
import yaml
from flask import Flask, render_template, jsonify, request
from flask_socketio import SocketIO, emit
from flask_cors import CORS

from core.easegen_client import EaseGenClient
from core.fay_connector import FayConnector
from core.playback_controller import PlaybackController

# åŠ è½½é…ç½®
with open('config.yaml', 'r', encoding='utf-8') as f:
    config = yaml.safe_load(f)

# åˆ›å»ºFlaskåº”ç”¨
app = Flask(__name__)
CORS(app)
socketio = SocketIO(app, cors_allowed_origins="*")

# åˆå§‹åŒ–å®¢æˆ·ç«¯
easegen_client = EaseGenClient(
    base_url=config['easegen']['base_url'],
    api_key=config['easegen']['api_key']
)

# WebSocketçŠ¶æ€å˜åŒ–å›è°ƒ
def on_state_change(state_data):
    """çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥å‰ç«¯"""
    socketio.emit('state_update', state_data)

# Fayæ¶ˆæ¯å›è°ƒ
def on_fay_message(message):
    """æ”¶åˆ°Fayæ¶ˆæ¯æ—¶è½¬å‘ç»™å‰ç«¯"""
    socketio.emit('fay_message', message)

# åˆå§‹åŒ–Fayè¿æ¥å™¨
fay_connector = FayConnector(
    websocket_url=config['fay']['websocket_url'],
    on_message_callback=on_fay_message
)

# åˆå§‹åŒ–æ’­æ”¾æ§åˆ¶å™¨
playback_controller = PlaybackController(
    easegen_client=easegen_client,
    fay_connector=fay_connector,
    on_state_change=on_state_change
)

# ==================== HTTP Routes ====================

@app.route('/')
def index():
    """ä¸»é¡µé¢"""
    return render_template('index.html')

@app.route('/api/config')
def get_config():
    """è·å–é…ç½®ä¿¡æ¯ï¼ˆä¾›å‰ç«¯ä½¿ç”¨ï¼‰"""
    return jsonify({
        'xmov': {
            'appId': config['xmov']['app_id'],
            'appSecret': config['xmov']['app_secret'],
            'gatewayServer': config['xmov']['gateway_server']
        },
        'playback': {
            'autoStart': config['playback']['auto_start']
        }
    })

@app.route('/api/courses')
def get_courses():
    """è·å–è¯¾ç¨‹åˆ—è¡¨"""
    page_no = request.args.get('pageNo', 1, type=int)
    page_size = request.args.get('pageSize', 10, type=int)

    result = easegen_client.get_course_list(page_no, page_size)

    if result:
        return jsonify({'code': 0, 'data': result})
    else:
        return jsonify({'code': 500, 'msg': 'è·å–è¯¾ç¨‹åˆ—è¡¨å¤±è´¥'})

@app.route('/api/play', methods=['POST'])
def start_play():
    """å¼€å§‹æ’­æ”¾"""
    data = request.json
    course_id = data.get('courseId', config['easegen']['default_course_id'])

    playback_controller.start_playback(course_id)

    return jsonify({'code': 0, 'msg': 'å¼€å§‹æ’­æ”¾'})

@app.route('/api/pause', methods=['POST'])
def pause_play():
    """æš‚åœæ’­æ”¾"""
    playback_controller.pause()
    return jsonify({'code': 0, 'msg': 'å·²æš‚åœ'})

@app.route('/api/resume', methods=['POST'])
def resume_play():
    """æ¢å¤æ’­æ”¾"""
    playback_controller.resume()
    return jsonify({'code': 0, 'msg': 'å·²æ¢å¤'})

@app.route('/api/ask', methods=['POST'])
def ask_question():
    """æé—®"""
    data = request.json
    question = data.get('question', '')

    if not question:
        return jsonify({'code': 400, 'msg': 'é—®é¢˜ä¸èƒ½ä¸ºç©º'})

    # æ‰“æ–­å½“å‰æ’­æ”¾
    playback_controller.interrupt()

    # å‘é€é—®é¢˜ç»™Fay
    fay_connector.send_text(question)

    # TODO: ç­‰å¾…Fayå›ç­”å®Œæˆåæ¢å¤æ’­æ”¾
    # è¿™é‡Œéœ€è¦ç›‘å¬Fayçš„å“åº”æ¥åˆ¤æ–­ä½•æ—¶å›ç­”å®Œæˆ

    return jsonify({'code': 0, 'msg': 'é—®é¢˜å·²å‘é€'})

# ==================== WebSocket Events ====================

@socketio.on('connect')
def handle_connect():
    """å®¢æˆ·ç«¯è¿æ¥"""
    print('[WebSocket] å®¢æˆ·ç«¯å·²è¿æ¥')
    emit('message', {'type': 'info', 'text': 'å·²è¿æ¥åˆ°æœåŠ¡å™¨'})

@socketio.on('disconnect')
def handle_disconnect():
    """å®¢æˆ·ç«¯æ–­å¼€"""
    print('[WebSocket] å®¢æˆ·ç«¯å·²æ–­å¼€')

@socketio.on('control')
def handle_control(data):
    """å¤„ç†æ§åˆ¶å‘½ä»¤"""
    action = data.get('action')

    if action == 'play':
        course_id = data.get('courseId', config['easegen']['default_course_id'])
        playback_controller.start_playback(course_id)
        emit('message', {'type': 'success', 'text': 'å¼€å§‹æ’­æ”¾'})

    elif action == 'pause':
        playback_controller.pause()
        emit('message', {'type': 'success', 'text': 'å·²æš‚åœ'})

    elif action == 'resume':
        playback_controller.resume()
        emit('message', {'type': 'success', 'text': 'å·²æ¢å¤'})

# ==================== å¯åŠ¨ ====================

if __name__ == '__main__':
    print("=" * 50)
    print("PPTLecturePlayer æ­£åœ¨å¯åŠ¨...")
    print(f"è®¿é—®åœ°å€: http://localhost:{config['server']['port']}")
    print("=" * 50)

    # è¿æ¥åˆ°Fay
    fay_connector.connect()

    # å¯åŠ¨Flaskåº”ç”¨
    socketio.run(
        app,
        host=config['server']['host'],
        port=config['server']['port'],
        debug=config['server']['debug']
    )
```

### é˜¶æ®µ4: å‰ç«¯é¡µé¢

**æ–‡ä»¶**: `templates/index.html`

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>PPTæ•°å­—äººè®²è§£ç³»ç»Ÿ</title>
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <!-- çŠ¶æ€æ  -->
  <div class="status-bar">
    <div class="status-info">
      <div class="status-item">
        <span class="status-dot" id="sdkStatus"></span>
        <span id="sdkStatusText">åˆå§‹åŒ–ä¸­...</span>
      </div>
      <div class="status-item">
        <span class="status-dot" id="fayStatus"></span>
        <span id="fayStatusText">æœªè¿æ¥Fay</span>
      </div>
      <div class="status-item">
        <span class="status-dot" id="easegenStatus"></span>
        <span id="easegenStatusText">æœªè¿æ¥EaseGen</span>
      </div>
    </div>
    <div style="font-size: 11px; color: #888;">
      PPTæ•°å­—äººè®²è§£ç³»ç»Ÿ v2.0
    </div>
  </div>

  <!-- PPTå…¨å±èƒŒæ™¯ -->
  <div id="ppt-background">
    <img id="ppt-image" src="" alt="PPT" style="display: none;">
    <div id="ppt-placeholder">
      <p>ç­‰å¾…åŠ è½½è¯¾ç¨‹...</p>
    </div>
  </div>

  <!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
  <div class="progress-indicator" id="progressIndicator" style="display: none;">
    <span id="currentProgress">0/0</span>
  </div>

  <!-- æ•°å­—äººæ‚¬æµ®çª—å£ -->
  <div id="sdk-container">
    <div id="sdk"></div>
  </div>

  <!-- æ§åˆ¶é¢æ¿ -->
  <div class="control-panel" id="controlPanel">
    <button id="playBtn" class="control-btn">å¼€å§‹æ’­æ”¾</button>
    <button id="pauseBtn" class="control-btn" style="display: none;">æš‚åœ</button>
    <div class="question-input">
      <input type="text" id="questionInput" placeholder="è¾“å…¥é—®é¢˜åæŒ‰å›è½¦...">
      <button id="askBtn" class="control-btn">æé—®</button>
    </div>
  </div>

  <!-- å¼•å…¥Xmov SDK -->
  <script src="https://media.youyan.xyz/youling-lite-sdk/index.umd.0.1.0-alpha.63.js"></script>

  <!-- å¼•å…¥Socket.IO -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

  <!-- å¼•å…¥å‰ç«¯é€»è¾‘ -->
  <script src="/static/js/player.js"></script>
</body>
</html>
```

**æ–‡ä»¶**: `static/css/style.css`

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  background: #000;
  overflow: hidden;
  width: 100vw;
  height: 100vh;
}

/* çŠ¶æ€æ  */
.status-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(10px);
  color: white;
  padding: 12px 20px;
  font-size: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 100;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.status-info {
  display: flex;
  align-items: center;
  gap: 20px;
}

.status-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #666;
  animation: pulse 2s infinite;
}

.status-dot.active {
  background: #4CAF50;
}

.status-dot.error {
  background: #f44336;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* PPTå…¨å±èƒŒæ™¯ */
#ppt-background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1;
  background: #1a1a1a;
  display: flex;
  justify-content: center;
  align-items: center;
}

#ppt-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: #000;
}

#ppt-placeholder {
  text-align: center;
  color: #888;
  font-size: 24px;
}

/* è¿›åº¦æŒ‡ç¤ºå™¨ */
.progress-indicator {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 50;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(10px);
  color: white;
  padding: 8px 20px;
  border-radius: 20px;
  font-size: 14px;
  border: 1px solid rgba(255,255,255,0.2);
}

/* æ•°å­—äººæ‚¬æµ®çª—å£ */
#sdk-container {
  position: fixed;
  bottom: 40px;
  right: 40px;
  z-index: 10;
  width: 320px;
  height: 480px;
  background: rgba(0,0,0,0.3);
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 10px 40px rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255,255,255,0.1);
}

#sdk {
  width: 100%;
  height: 100%;
  background: #000;
}

/* æ§åˆ¶é¢æ¿ */
.control-panel {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 60;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  padding: 15px 20px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.2);
  display: flex;
  gap: 10px;
  align-items: center;
}

.control-btn {
  background: #4CAF50;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s;
}

.control-btn:hover {
  background: #45a049;
}

.question-input {
  display: flex;
  gap: 10px;
}

.question-input input {
  padding: 10px 15px;
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  background: rgba(255,255,255,0.1);
  color: white;
  font-size: 14px;
  width: 300px;
}

.question-input input::placeholder {
  color: rgba(255,255,255,0.5);
}
```

**æ–‡ä»¶**: `static/js/player.js`

```javascript
// PPTè®²è§£ç³»ç»Ÿå‰ç«¯é€»è¾‘

let socket;
let xmovSDK = null;
let config = null;

// åˆå§‹åŒ–
async function init() {
  console.log('[Player] åˆå§‹åŒ–ä¸­...');

  // è·å–é…ç½®
  const configRes = await fetch('/api/config');
  config = await configRes.json();

  // åˆå§‹åŒ–Socket.IO
  initSocketIO();

  // åˆå§‹åŒ–Xmov SDK
  initXmovSDK();

  // ç»‘å®šäº‹ä»¶
  bindEvents();
}

// åˆå§‹åŒ–Socket.IO
function initSocketIO() {
  socket = io();

  socket.on('connect', () => {
    console.log('[Socket.IO] å·²è¿æ¥åˆ°æœåŠ¡å™¨');
    updateServerStatus('active');
  });

  socket.on('disconnect', () => {
    console.log('[Socket.IO] å·²æ–­å¼€è¿æ¥');
    updateServerStatus('error');
  });

  socket.on('state_update', (data) => {
    console.log('[çŠ¶æ€æ›´æ–°]', data);
    handleStateUpdate(data);
  });

  socket.on('fay_message', (message) => {
    console.log('[Fayæ¶ˆæ¯]', message);
    handleFayMessage(message);
  });

  socket.on('message', (data) => {
    console.log('[æ¶ˆæ¯]', data.text);
  });
}

// åˆå§‹åŒ–Xmov SDK
function initXmovSDK() {
  updateSDKStatus('æ­£åœ¨åˆå§‹åŒ–...', false);

  try {
    xmovSDK = new XmovAvatar({
      containerId: '#sdk',
      appId: config.xmov.appId,
      appSecret: config.xmov.appSecret,
      gatewayServer: config.xmov.gatewayServer,

      onVoiceStateChange(status) {
        console.log('[Xmov] è¯­éŸ³çŠ¶æ€:', status);
        if (status === 'start') {
          updateSDKStatus('æ­£åœ¨è¯´è¯', true);
        } else if (status === 'end') {
          updateSDKStatus('å°±ç»ª', true);
        }
      },

      enableLogger: true
    });

    xmovSDK.init({
      onDownloadProgress: (progress) => {
        updateSDKStatus(`åŠ è½½èµ„æº ${progress}%`, false);
      },
      onError: (error) => {
        console.error('[Xmov] SDKé”™è¯¯:', error);
        updateSDKStatus('åˆå§‹åŒ–å¤±è´¥', false, true);
      }
    }).then(() => {
      updateSDKStatus('å°±ç»ª', true);
    });

  } catch (error) {
    console.error('[Xmov] åˆ›å»ºSDKå®ä¾‹å¤±è´¥:', error);
    updateSDKStatus('åˆå§‹åŒ–å¤±è´¥', false, true);
  }
}

// å¤„ç†çŠ¶æ€æ›´æ–°
function handleStateUpdate(data) {
  if (data.type === 'ppt_update') {
    const pptData = data.data;

    // æ›´æ–°PPTå›¾ç‰‡
    const pptImage = document.getElementById('ppt-image');
    const pptPlaceholder = document.getElementById('ppt-placeholder');

    pptImage.src = pptData.imageUrl;
    pptImage.style.display = 'block';
    pptPlaceholder.style.display = 'none';

    // æ›´æ–°è¿›åº¦
    const progressIndicator = document.getElementById('progressIndicator');
    const currentProgress = document.getElementById('currentProgress');

    currentProgress.textContent = pptData.progress || `${pptData.currentNo}/${pptData.totalNo}`;
    progressIndicator.style.display = 'block';

    updateEaseGenStatus('å·²è¿æ¥', true);
  }
}

// å¤„ç†Fayæ¶ˆæ¯
function handleFayMessage(message) {
  if (message.Topic === 'human' && message.Data) {
    const data = message.Data;

    // å¤„ç†æ–‡æœ¬æ¶ˆæ¯
    if (data.Key === 'text') {
      const text = data.Value || '';
      const isFirst = data.IsFirst === 1;
      const isEnd = data.IsEnd === 1;

      if (text && text.trim() && xmovSDK) {
        console.log('[Xmov] æ•°å­—äººè¯´è¯:', text);
        xmovSDK.speak(text, isFirst, isEnd);
      }
    }
  }

  updateFayStatus('å·²è¿æ¥', true);
}

// ç»‘å®šäº‹ä»¶
function bindEvents() {
  // æ’­æ”¾æŒ‰é’®
  document.getElementById('playBtn').addEventListener('click', () => {
    socket.emit('control', { action: 'play' });
    document.getElementById('playBtn').style.display = 'none';
    document.getElementById('pauseBtn').style.display = 'inline-block';
  });

  // æš‚åœæŒ‰é’®
  document.getElementById('pauseBtn').addEventListener('click', () => {
    socket.emit('control', { action: 'pause' });
    document.getElementById('playBtn').style.display = 'inline-block';
    document.getElementById('pauseBtn').style.display = 'none';
  });

  // æé—®æŒ‰é’®
  document.getElementById('askBtn').addEventListener('click', askQuestion);

  // å›è½¦æé—®
  document.getElementById('questionInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      askQuestion();
    }
  });
}

// æé—®
async function askQuestion() {
  const input = document.getElementById('questionInput');
  const question = input.value.trim();

  if (!question) {
    alert('è¯·è¾“å…¥é—®é¢˜');
    return;
  }

  const res = await fetch('/api/ask', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ question })
  });

  const result = await res.json();
  console.log('[æé—®]', result.msg);

  input.value = '';
}

// æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
function updateSDKStatus(text, isActive = false, isError = false) {
  const dot = document.getElementById('sdkStatus');
  const textEl = document.getElementById('sdkStatusText');

  dot.className = 'status-dot';
  if (isActive) dot.classList.add('active');
  if (isError) dot.classList.add('error');

  textEl.textContent = text;
}

function updateFayStatus(text, isActive = false) {
  const dot = document.getElementById('fayStatus');
  const textEl = document.getElementById('fayStatusText');

  dot.className = 'status-dot';
  if (isActive) dot.classList.add('active');

  textEl.textContent = text;
}

function updateEaseGenStatus(text, isActive = false) {
  const dot = document.getElementById('easegenStatus');
  const textEl = document.getElementById('easegenStatusText');

  dot.className = 'status-dot';
  if (isActive) dot.classList.add('active');

  textEl.textContent = text;
}

function updateServerStatus(status) {
  // å¯ä»¥æ·»åŠ æœåŠ¡å™¨çŠ¶æ€æŒ‡ç¤ºå™¨
}

// é¡µé¢åŠ è½½ååˆå§‹åŒ–
window.onload = init;
```

---

## å¯¹ç°æœ‰ç³»ç»Ÿçš„ä¿®æ”¹

### ğŸ¯ ä¸¤ç§å®æ–½æ–¹æ¡ˆå¯¹æ¯”

æœ¬ç³»ç»Ÿæä¾›ä¸¤ç§å®æ–½æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ï¼š

| æ–¹æ¡ˆ | Fayä¿®æ”¹ | åŒæ­¥æœºåˆ¶ | å¯é æ€§ | å¤æ‚åº¦ | æ¨èåº¦ |
|------|---------|---------|--------|--------|--------|
| **æ–¹æ¡ˆA: HashåŒ¹é…** | âŒ é›¶ä¿®æ”¹ | æ–‡æœ¬å“ˆå¸Œ | â­â­â­ | é«˜ | å¿«é€ŸéªŒè¯ |
| **æ–¹æ¡ˆB: æ¶ˆæ¯ç±»å‹** | âœ… å°ä¿®æ”¹(50è¡Œ) | ç±»å‹å­—æ®µ | â­â­â­â­â­ | ä½ | â­â­â­â­â­ æ¨è |

---

### æ–¹æ¡ˆA: HashåŒ¹é…æ–¹æ¡ˆï¼ˆé›¶ä¿®æ”¹ï¼‰

**é€‚ç”¨åœºæ™¯**: å¿«é€ŸéªŒè¯ä¸šåŠ¡å¯è¡Œæ€§ï¼Œä¸æƒ³æ”¹åŠ¨Fay

#### ç³»ç»Ÿä¿®æ”¹æ¸…å•

| ç³»ç»Ÿ | æ˜¯å¦ä¿®æ”¹ | è¯´æ˜ |
|------|---------|------|
| **EaseGen** | âŒ å¦ | å·²æä¾›APIæ¥å£ï¼Œæ— éœ€ä¿®æ”¹ |
| **Fay** | âŒ å¦ | **å·²æ”¯æŒ**WebSocketå®¢æˆ·ç«¯å‘é€æ–‡æœ¬ |
| **Xmov** | âŒ å¦ | ä½¿ç”¨CDNçš„SDKï¼Œå‰ç«¯åµŒå…¥å³å¯ |
| **æ–°æ¨¡å—** | âœ… æ–°å»º | å®Œå…¨ç‹¬ç«‹çš„æ–°ç›®å½• |

è¯¦è§å‰æ–‡"åŒæ­¥æœºåˆ¶è¯¦è§£"ç« èŠ‚ã€‚

---

### æ–¹æ¡ˆB: æ¶ˆæ¯ç±»å‹æ‰©å±•æ–¹æ¡ˆï¼ˆæ¨èï¼‰â­

**é€‚ç”¨åœºæ™¯**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼Œè¿½æ±‚é«˜å¯é æ€§å’Œæ˜“ç»´æŠ¤æ€§

#### æ ¸å¿ƒæ€è·¯

åœ¨Fayçš„WebSocketæ¶ˆæ¯ä¸­æ·»åŠ `messageType`å’Œ`metadata`å­—æ®µï¼Œè®©æ¶ˆæ¯è‡ªæè¿°ï¼Œæ— éœ€å‰ç«¯çŒœæµ‹ã€‚

#### æ¶ˆæ¯æ ¼å¼å¯¹æ¯”

**åŸæ¶ˆæ¯æ ¼å¼**ï¼ˆFayå½“å‰ï¼‰:
```json
{
  "Topic": "human",
  "Data": {
    "Key": "text",
    "Value": "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹...",
    "IsFirst": 1,
    "IsEnd": 0
  }
}
```

**æ–°æ¶ˆæ¯æ ¼å¼**ï¼ˆæ‰©å±•åï¼‰:
```json
{
  "Topic": "human",
  "Data": {
    "Key": "text",
    "Value": "æ¬¢è¿æ¥åˆ°äººå·¥æ™ºèƒ½è¯¾ç¨‹...",
    "IsFirst": 1,
    "IsEnd": 0,
    "messageType": "course",  // â† æ–°å¢ï¼šæ¶ˆæ¯ç±»å‹
    "metadata": {             // â† æ–°å¢ï¼šå…ƒæ•°æ®
      "courseId": "1024",
      "segmentNo": 1,
      "totalSegments": 50,
      "pptImageUrl": "https://example.com/ppt/page1.jpg"
    }
  }
}
```

**messageTypeæšä¸¾**:
- `"course"` - è¯¾ç¨‹è®²è§£å†…å®¹ï¼ˆéœ€æ˜¾ç¤ºPPTï¼‰
- `"qa"` - ç”¨æˆ·é—®ç­”ï¼ˆä¸æ˜¾ç¤ºPPTï¼‰
- `"notification"` - ç³»ç»Ÿé€šçŸ¥
- `null` - é»˜è®¤å€¼ï¼Œå…¼å®¹æ—§ç‰ˆ

#### Fayä¿®æ”¹è¯¦è§£

##### ä¿®æ”¹1: Interactç±»æ”¯æŒå…ƒæ•°æ®

**æ–‡ä»¶**: `Fay/core/interact.py`

**ä½ç½®**: `Interact` ç±»å®šä¹‰

```python
class Interact:
    def __init__(self, interact_type, user_id, data):
        self.type = interact_type
        self.user_id = user_id
        self.data = data
        self.text = ""

        # ===== æ–°å¢ï¼šæ”¯æŒå…ƒæ•°æ® =====
        self.metadata = None  # å¤–éƒ¨å¯æ³¨å…¥çš„å…ƒæ•°æ®
        # ===== æ–°å¢ç»“æŸ =====
```

**ä¿®æ”¹è¡Œæ•°**: 1è¡Œ

---

##### ä¿®æ”¹2: WebSocketæ¶ˆæ¯æ„é€ æ—¶æ·»åŠ å…ƒæ•°æ®

**æ–‡ä»¶**: `Fay/core/fay_core.py`

**ä½ç½®**: `__process_output_audio()` æ–¹æ³•ä¸­æ„é€ æ¶ˆæ¯çš„éƒ¨åˆ†

**æŸ¥æ‰¾ä»£ç **ï¼ˆå¤§çº¦åœ¨ç¬¬597è¡Œé™„è¿‘ï¼‰:
```python
def __process_output_audio(self, ...):
    # ... åŸæœ‰ä»£ç  ...

    # æ„é€ WebSocketæ¶ˆæ¯
    message = {
        'Topic': 'human',
        'Data': {
            'Key': 'text',
            'Value': text,
            'IsFirst': is_first,
            'IsEnd': is_end
        }
    }

    # å‘é€æ¶ˆæ¯
    wsa_server.get_web_instance().add_cmd(message)
```

**ä¿®æ”¹ä¸º**:
```python
def __process_output_audio(self, interact, ...):  # æ³¨æ„ï¼šéœ€è¦ä¼ å…¥interactå‚æ•°
    # ... åŸæœ‰ä»£ç  ...

    # æ„é€ WebSocketæ¶ˆæ¯
    message = {
        'Topic': 'human',
        'Data': {
            'Key': 'text',
            'Value': text,
            'IsFirst': is_first,
            'IsEnd': is_end
        }
    }

    # ===== æ–°å¢ï¼šæ·»åŠ å…ƒæ•°æ®æ”¯æŒ =====
    if hasattr(interact, 'metadata') and interact.metadata:
        message['Data']['messageType'] = interact.metadata.get('type', 'qa')
        message['Data']['metadata'] = interact.metadata
    else:
        message['Data']['messageType'] = None  # å…¼å®¹æ—§ç‰ˆ
    # ===== æ–°å¢ç»“æŸ =====

    # å‘é€æ¶ˆæ¯
    wsa_server.get_web_instance().add_cmd(message)
```

**ä¿®æ”¹è¡Œæ•°**: çº¦8è¡Œ

**æ³¨æ„**: éœ€è¦ç¡®ä¿`__process_output_audio`æ–¹æ³•èƒ½å¤Ÿè®¿é—®åˆ°`interact`å¯¹è±¡ã€‚å¦‚æœå½“å‰æ²¡æœ‰ï¼Œéœ€è¦é€šè¿‡å‚æ•°ä¼ é€’ã€‚

---

##### ä¿®æ”¹3: WebSocketæ¥æ”¶æ¶ˆæ¯æ—¶æ”¯æŒå…ƒæ•°æ®

**æ–‡ä»¶**: `Fay/core/wsa_server.py`

**ä½ç½®**: `HumanServer` ç±»çš„ `on_message` æ–¹æ³•

**æŸ¥æ‰¾ä»£ç **ï¼ˆå¤§çº¦åœ¨ç¬¬XXXè¡Œï¼‰:
```python
def on_message(self, message):
    """å¤„ç†WebSocketæ¶ˆæ¯"""
    try:
        data = json.loads(message)

        # ç°æœ‰çš„å¤„ç†é€»è¾‘
        if data.get('Username'):
            # åˆå§‹åŒ–è¿æ¥
            pass

        # ... å…¶ä»–å¤„ç† ...
```

**ä¿®æ”¹ä¸º**:
```python
def on_message(self, message):
    """å¤„ç†WebSocketæ¶ˆæ¯"""
    try:
        data = json.loads(message)

        # ç°æœ‰çš„å¤„ç†é€»è¾‘
        if data.get('Username'):
            # åˆå§‹åŒ–è¿æ¥
            pass

        # ===== æ–°å¢ï¼šæ”¯æŒå¸¦å…ƒæ•°æ®çš„æ–‡æœ¬å¤„ç† =====
        elif data.get('action') == 'speak' and data.get('text'):
            # åˆ›å»ºInteract
            from core.interact import Interact
            interact = Interact("external_text", 0, {})
            interact.text = data.get('text', '')

            # æ³¨å…¥å…ƒæ•°æ®
            if data.get('metadata'):
                interact.metadata = data.get('metadata')

            # å¤„ç†
            feiFei.on_interact(interact)
            return
        # ===== æ–°å¢ç»“æŸ =====

        # ... å…¶ä»–å¤„ç† ...
```

**ä¿®æ”¹è¡Œæ•°**: çº¦15è¡Œ

---

#### ä¿®æ”¹æ€»ç»“

| æ–‡ä»¶ | ä¿®æ”¹ä½ç½® | ä¿®æ”¹è¡Œæ•° | éš¾åº¦ |
|------|---------|---------|------|
| `core/interact.py` | Interactç±» | 1è¡Œ | â­ ç®€å• |
| `core/fay_core.py` | `__process_output_audio()` | 8è¡Œ | â­â­ ä¸­ç­‰ |
| `core/wsa_server.py` | `on_message()` | 15è¡Œ | â­â­ ä¸­ç­‰ |
| **æ€»è®¡** | 3ä¸ªæ–‡ä»¶ | **çº¦24è¡Œ** | **å®¹æ˜“** |

---

#### æ–°æ¨¡å—è°ƒæ•´

ä½¿ç”¨æ–¹æ¡ˆBæ—¶ï¼Œæ–°æ¨¡å—çš„`fay_connector.py`éœ€è¦è°ƒæ•´ï¼š

**æ–‡ä»¶**: `PPTLecturePlayer/core/fay_connector.py`

```python
def send_course_text(self, text: str, segment_data: dict):
    """
    å‘é€è¯¾ç¨‹æ–‡æœ¬ç»™Fayï¼Œæºå¸¦å®Œæ•´å…ƒæ•°æ®

    Args:
        text: è¯¾ç¨‹è®²ç¨¿æ–‡æœ¬
        segment_data: ä»EaseGen APIè·å–çš„ç‰‡æ®µæ•°æ®
    """
    if not self.connected:
        print("[Fay] æœªè¿æ¥ï¼Œæ— æ³•å‘é€æ–‡æœ¬")
        return False

    try:
        message = {
            'action': 'speak',
            'text': text,
            'metadata': {
                'type': 'course',
                'courseId': segment_data.get('courseId', ''),
                'segmentNo': segment_data.get('currentNo', 0),
                'totalSegments': segment_data.get('totalNo', 0),
                'pptImageUrl': segment_data.get('img', '')
            }
        }

        self.ws.send(json.dumps(message))
        print(f"[Fay] å·²å‘é€è¯¾ç¨‹ç‰‡æ®µ {segment_data.get('currentNo')}/{segment_data.get('totalNo')}")
        return True

    except Exception as e:
        print(f"[Fay] å‘é€å¤±è´¥: {e}")
        return False
```

---

#### å‰ç«¯ç®€åŒ–ï¼ˆå•WebSocketï¼‰

ä½¿ç”¨æ–¹æ¡ˆBæ—¶ï¼Œå‰ç«¯**åªéœ€è¿æ¥Fayçš„WebSocket**ï¼Œæ— éœ€è¿æ¥æ–°æ¨¡å—ï¼

**æ–‡ä»¶**: `PPTLecturePlayer/static/js/player.js`

```javascript
// åªéœ€ä¸€ä¸ªWebSocketè¿æ¥
const fayWS = new WebSocket('ws://127.0.0.1:10002');

fayWS.onopen = () => {
  console.log('[Fay] å·²è¿æ¥');

  // å‘é€åˆå§‹åŒ–æ¶ˆæ¯
  fayWS.send(JSON.stringify({
    Username: 'PPTLecturePlayer',
    Output: false
  }));
};

fayWS.onmessage = (event) => {
  const msg = JSON.parse(event.data);

  if (msg.Topic === 'human' && msg.Data) {
    const data = msg.Data;

    // æ ¹æ®messageTypeåˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºPPT
    if (data.messageType === 'course' && data.metadata) {
      // è¯¾ç¨‹å†…å®¹ - æ˜¾ç¤ºPPT
      const metadata = data.metadata;

      console.log(`[PPT] æ˜¾ç¤ºç¬¬${metadata.segmentNo}é¡µ`);
      showPPT(metadata.pptImageUrl);
      updateProgress(metadata.segmentNo, metadata.totalSegments);

    } else if (data.messageType === 'qa') {
      // ç”¨æˆ·é—®ç­” - ä¸å¤„ç†PPT
      console.log('[QA] ç”¨æˆ·é—®ç­”ï¼Œä¿æŒå½“å‰PPT');
    }

    // æ— è®ºä»€ä¹ˆç±»å‹ï¼Œéƒ½ä¼ ç»™Xmov SDK
    if (data.Key === 'text') {
      xmovSDK.speak(data.Value, data.IsFirst, data.IsEnd);
    }
  }
};

// æ˜¾ç¤ºPPTçš„å‡½æ•°ï¼ˆæç®€ï¼‰
function showPPT(imageUrl) {
  const pptImage = document.getElementById('ppt-image');
  pptImage.src = imageUrl;
  pptImage.style.display = 'block';
}

// æ›´æ–°è¿›åº¦
function updateProgress(current, total) {
  const progressEl = document.getElementById('progress');
  progressEl.textContent = `${current}/${total}`;
}
```

**å¯¹æ¯”**:
- æ–¹æ¡ˆAéœ€è¦åŒWebSocket + HashåŒ¹é…ï¼ˆçº¦100è¡Œä»£ç ï¼‰
- æ–¹æ¡ˆBåªéœ€å•WebSocket + ç±»å‹åˆ¤æ–­ï¼ˆçº¦50è¡Œä»£ç ï¼‰

---

#### ä¼˜åŠ¿åˆ†æ

##### 1. é›¶æ­§ä¹‰
```
âœ… é€šè¿‡messageTypeç›´æ¥åˆ¤æ–­ï¼Œæ— éœ€çŒœæµ‹
âœ… ä¸å—LLMæ”¹å†™å½±å“
âœ… 100%å¯é 
```

##### 2. å‰ç«¯æç®€
```javascript
// ä¸€è¡Œåˆ¤æ–­
if (msg.Data.messageType === 'course') {
  showPPT(msg.Data.metadata.pptImageUrl);
}
```

##### 3. å…ƒæ•°æ®ä¸°å¯Œ
```json
{
  "metadata": {
    "courseId": "1024",
    "segmentNo": 1,
    "totalSegments": 50,
    "pptImageUrl": "https://...",
    "duration": 15,           // é¢„è®¡æ—¶é•¿
    "keywords": ["AI"],       // å…³é”®è¯
    "hasQuiz": true,          // æ˜¯å¦æœ‰æµ‹éªŒ
    "chapterName": "ç¬¬ä¸€ç« "    // ç« èŠ‚å
  }
}
```

##### 4. æ˜“äºæ‰©å±•
```javascript
// è½»æ¾æ·»åŠ æ–°ç±»å‹
if (msg.Data.messageType === 'quiz') {
  showQuiz(msg.Data.metadata);
} else if (msg.Data.messageType === 'poll') {
  showPoll(msg.Data.metadata);
}
```

##### 5. å‘åå…¼å®¹
```python
# messageTypeä¸ºnullæ—¶ï¼ŒæŒ‰åŸæœ‰é€»è¾‘å¤„ç†
if message['Data']['messageType'] is None:
    # æ—§ç‰ˆæ¶ˆæ¯ï¼ŒæŒ‰åŸæœ‰æ–¹å¼å¤„ç†
```

---

#### å®æ–½æ­¥éª¤

##### é˜¶æ®µ1: ä¿®æ”¹Fayï¼ˆ1å°æ—¶ï¼‰

1. ä¿®æ”¹ `core/interact.py` - æ·»åŠ metadataå±æ€§
2. ä¿®æ”¹ `core/fay_core.py` - è¾“å‡ºæ—¶æºå¸¦å…ƒæ•°æ®
3. ä¿®æ”¹ `core/wsa_server.py` - æ¥æ”¶æ—¶æ”¯æŒå…ƒæ•°æ®
4. æµ‹è¯•ï¼šå‘é€å¸¦metadataçš„æ¶ˆæ¯ï¼Œæ£€æŸ¥è¾“å‡º

##### é˜¶æ®µ2: è°ƒæ•´æ–°æ¨¡å—ï¼ˆ30åˆ†é’Ÿï¼‰

1. ä¿®æ”¹ `core/fay_connector.py` - å‘é€æ—¶æºå¸¦å…ƒæ•°æ®
2. ç®€åŒ–å‰ç«¯ `static/js/player.js` - åˆ é™¤Hashé€»è¾‘
3. æµ‹è¯•ï¼šæ£€æŸ¥metadataæ˜¯å¦æ­£ç¡®ä¼ é€’

##### é˜¶æ®µ3: é›†æˆæµ‹è¯•ï¼ˆ30åˆ†é’Ÿï¼‰

1. å¯åŠ¨Fay
2. å¯åŠ¨æ–°æ¨¡å—
3. æµ‹è¯•è¯¾ç¨‹æ’­æ”¾ - éªŒè¯PPTæ˜¾ç¤º
4. æµ‹è¯•ç”¨æˆ·æé—® - éªŒè¯PPTä¸å˜

**æ€»è€—æ—¶**: çº¦2å°æ—¶

---

### æ–¹æ¡ˆé€‰æ‹©å»ºè®®

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|------|---------|------|
| **å¿«é€ŸéªŒè¯** | æ–¹æ¡ˆAï¼ˆHashï¼‰ | é›¶ä¿®æ”¹ï¼Œå¿«é€Ÿä¸Šçº¿ |
| **ç”Ÿäº§éƒ¨ç½²** | æ–¹æ¡ˆBï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰| å¯é æ€§é«˜ï¼Œæ˜“ç»´æŠ¤ |
| **é•¿æœŸä½¿ç”¨** | æ–¹æ¡ˆBï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰| æ˜“æ‰©å±•ï¼Œä»£ç ç®€æ´ |
| **å›¢é˜Ÿåä½œ** | æ–¹æ¡ˆBï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰| è¯­ä¹‰æ¸…æ™°ï¼Œæ˜“ç†è§£ |

**å»ºè®®è·¯å¾„**:
1. å…ˆç”¨æ–¹æ¡ˆAéªŒè¯ä¸šåŠ¡ï¼ˆ1-2å¤©ï¼‰
2. ç¡®è®¤å¯è¡Œåï¼Œå‡çº§åˆ°æ–¹æ¡ˆBï¼ˆåŠå¤©ï¼‰
3. äº«å—ä¼˜é›…æ¶æ„å¸¦æ¥çš„ä¾¿åˆ©

---

## é…ç½®æ–‡ä»¶

### æ–°æ¨¡å—é…ç½®

**æ–‡ä»¶**: `PPTLecturePlayer/config.yaml`

```yaml
server:
  host: '0.0.0.0'
  port: 5003
  debug: true

easegen:
  base_url: 'http://localhost:48080'  # éœ€è¦æ ¹æ®å®é™…éƒ¨ç½²è°ƒæ•´
  api_key: 'YOUR_API_KEY_HERE'        # **ç”¨æˆ·éœ€è¦å¡«å†™**
  default_course_id: '1024'

fay:
  websocket_url: 'ws://127.0.0.1:10002'
  reconnect_interval: 5

xmov:
  app_id: 'your_app_id'
  app_secret: 'your_app_secret'
  gateway_server: 'https://nebula-agent.xingyun3d.com/user/v1/ttsa/session'

playback:
  auto_start: false
  loop: true
  page_interval: 2
  speech_speed_multiplier: 1.0
```

---

## OBSé…ç½®

### æ¨æµæ–¹æ¡ˆ

ä¸v1.0æ–¹æ¡ˆç›¸åŒï¼Œä½¿ç”¨çª—å£æ•è·ï¼š

1. æµè§ˆå™¨è®¿é—® `http://localhost:5003`
2. F11å…¨å±
3. OBSæ·»åŠ "çª—å£æ•è·"æº
4. é€‰æ‹©æµè§ˆå™¨çª—å£
5. è°ƒæ•´ç”»é¢å°ºå¯¸
6. å¼€å§‹æ¨æµ

---

## æµ‹è¯•æ–¹æ¡ˆ

### å•å…ƒæµ‹è¯•

#### æµ‹è¯•EaseGenå®¢æˆ·ç«¯

```bash
cd PPTLecturePlayer
.venv\Scripts\activate
python -c "
from core.easegen_client import EaseGenClient
client = EaseGenClient('http://localhost:48080', 'YOUR_API_KEY')
result = client.get_course_text('1024', 1)
print(result)
"
```

### é›†æˆæµ‹è¯•

1. å¯åŠ¨Fay: `cd Fay && .venv\Scripts\python.exe main.py`
2. å¯åŠ¨æ–°æ¨¡å—: `cd PPTLecturePlayer && python start.py`
3. æµè§ˆå™¨è®¿é—®: `http://localhost:5003`
4. ç‚¹å‡»"å¼€å§‹æ’­æ”¾"

**é¢„æœŸç»“æœ**:
- âœ… PPTå›¾ç‰‡æ˜¾ç¤º
- âœ… æ•°å­—äººå¼€å§‹è®²è§£
- âœ… è‡ªåŠ¨ç¿»é¡µ
- âœ… å¯ä»¥æ‰“æ–­æé—®

---

## éƒ¨ç½²è¯´æ˜

### å¯åŠ¨é¡ºåº

1. **å¯åŠ¨Fay** (å¿…é¡»):
   ```bash
   cd E:/code/yzpd/easegen-front/opensource-demos/Fay
   .venv\Scripts\python.exe main.py
   ```

2. **å¯åŠ¨PPTLecturePlayer** (æ–°æ¨¡å—):
   ```bash
   cd E:/code/yzpd/easegen-front/opensource-demos/PPTLecturePlayer
   .venv\Scripts\activate
   python start.py
   ```

3. **è®¿é—®é¡µé¢**:
   ```
   http://localhost:5003
   ```

### ç¯å¢ƒè¦æ±‚

- Python 3.13.6
- EaseGenåç«¯è¿è¡Œåœ¨ 48080 ç«¯å£
- Fayè¿è¡Œåœ¨ 5000 ç«¯å£ï¼ŒWebSocket 10002 ç«¯å£
- æ–°æ¨¡å—è¿è¡Œåœ¨ 5003 ç«¯å£

---

## æ€»ç»“

### æ¨¡å—èŒè´£

| æ¨¡å— | èŒè´£ | ç«¯å£ | ä¿®æ”¹æƒ…å†µ |
|------|------|------|----------|
| **EaseGen** | æä¾›è¯¾ç¨‹æ•°æ®API | 48080 | æ— éœ€ä¿®æ”¹ |
| **Fay** | TTSã€LLMæœåŠ¡ | 5000, 10002 | æœ€å°ä¿®æ”¹ï¼ˆ10è¡Œä»£ç ï¼‰ |
| **Xmov** | 3Dæ•°å­—äººæ¸²æŸ“ | SDK(CDN) | æ— éœ€ä¿®æ”¹ |
| **PPTLecturePlayer** | ä¸­é—´å±‚åè°ƒ | 5003 | **æ–°å»ºæ¨¡å—** |

### ä¼˜åŠ¿

âœ… **ç‹¬ç«‹éƒ¨ç½²**: æ–°æ¨¡å—å®Œå…¨ç‹¬ç«‹ï¼Œå¯å•ç‹¬å¯åŠ¨/åœæ­¢
âœ… **æœ€å°ä¾µå…¥**: Fayå’ŒXmovå‡ ä¹æ— éœ€ä¿®æ”¹
âœ… **æ˜“äºç»´æŠ¤**: ä»£ç ç»“æ„æ¸…æ™°ï¼Œé…ç½®ç»Ÿä¸€ç®¡ç†
âœ… **å¯æ‰©å±•**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½ï¼ˆå¦‚è¯¾ç¨‹é€‰æ‹©ã€è¿›åº¦ä¿å­˜ï¼‰

---

**æ–¹æ¡ˆç»“æŸ**

è¯·æ£€æŸ¥æœ¬æ–¹æ¡ˆå¹¶ç¡®è®¤æ˜¯å¦å¯ä»¥å¼€å§‹å®æ–½ã€‚å¦‚æœ‰ä¿®æ”¹å»ºè®®ï¼Œè¯·éšæ—¶å‘ŠçŸ¥ï¼
